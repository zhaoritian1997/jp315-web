"use strict";(self["webpackChunkvue_antd_pro"]=self["webpackChunkvue_antd_pro"]||[]).push([[344],{8534:function(e,n,t){t.d(n,{w:function(){return d}});var i=t(52160),d=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,d=[];function a(e,r){if(e&&(r>=n&&r<=t&&d.push(e.id),e.children)){var s,o=(0,i.A)(e.children);try{for(o.s();!(s=o.n()).done;){var c=s.value;a(c,r+1)}}catch(l){o.e(l)}finally{o.f()}}}var r,s=(0,i.A)(e);try{for(s.s();!(r=s.n()).done;){var o=r.value;a(o,1)}}catch(c){s.e(c)}finally{s.f()}return d}},10963:function(e,n,t){t.d(n,{y:function(){return i}});t(79640),t(55894),t(22098),t(54011);var i=function(e){var n={0:"零",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"七",8:"八",9:"九",10:"十"},t=["","十","百"],i="";if(0===e)return n[0];if(e<10)return n[e];for(var d=e.toString().split("").reverse(),a=0;a<d.length;a++){var r=parseInt(d[a]);0!==r?i=1===a&&1===r?t[a]+i:n[r]+t[a]+i:i=n[r]+i}return i.replace(/零(?=[^百]*$)/g,"")}},11637:function(e,n,t){t.d(n,{P:function(){return d},r:function(){return a}});var i=t(46030),d={"分房":1,"分屋":2,"分支":3,"分派":4},a=(0,i.A)((0,i.A)((0,i.A)((0,i.A)({},d.分房,"房"),d.分屋,"屋"),d.分支,"支"),d.分派,"派")},14277:function(e,n,t){t.d(n,{T:function(){return d},c:function(){return i}});var i=[{id:1,icon:"",name:"默认"},{id:2,icon:"",name:"强制立传"},{id:3,icon:"",name:"强制不立传"},{id:4,icon:"",name:"仅自身不立传"},{id:5,icon:"",name:"仅吊线图显示"},{id:6,icon:"",name:"仅世系表显示"},{id:7,icon:"",name:"世系表不显示"},{id:8,icon:"",name:"隐藏"}],d=[{id:"1",name:"默认输出"},{id:"2",name:"全部合并输出(起始世系数必须相同)"},{id:"3",name:"检索表合并输出"},{id:"4",name:"检索表&世系图合并输出"}]},24377:function(e,n,t){t.d(n,{g:function(){return a}});t(28129);var i=t(92935),d=t(10963),a=function(e,n){var t="女"===n?"女":"子";if(1===e)return"长".concat(t||"子");if(2===e)return"次".concat(t||"子");if((0,i.isNumber)(e)){var a=(0,d.y)(e);return"".concat(a).concat(t||"子")}return"".concat(e).concat(t||"子")}},43476:function(e,n,t){t.d(n,{A:function(){return o}});var i=t(3577);function d(e){if(Array.isArray(e))return(0,i.A)(e)}t(98308),t(93116),t(44266),t(6413),t(79640),t(24897),t(22432);function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var r=t(47991);function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e){return d(e)||a(e)||(0,r.A)(e)||s()}},44586:function(e,n,t){t.r(n),t.d(n,{PX_RIGHT_OPTION_ADD_ANCESTOR:function(){return r},PX_RIGHT_OPTION_ADD_BROTHER:function(){return a},PX_RIGHT_OPTION_ADD_CHILD:function(){return d},PX_RIGHT_OPTION_ADD_WIFE:function(){return i},PX_RIGHT_OPTION_DELETE_NODE:function(){return s}});var i="PX_RIGHT_OPTION_ADD_WIFE",d="PX_RIGHT_OPTION_ADD_CHILD",a="PX_RIGHT_OPTION_ADD_BROTHER",r="PX_RIGHT_OPTION_ADD_ANCESTOR",s="PX_RIGHT_OPTION_DELETE_NODE"},69475:function(e,n,t){t.d(n,{_:function(){return d}});t(88116),t(26243);var i=["欧阳","太史","端木","上官","司马","东方","独孤","南宫","万俟","闻人","夏侯","诸葛","尉迟","公羊","赫连","澹台","皇甫","宗政","濮阳","公冶","太叔","申屠","公孙","慕容","仲孙","钟离","长孙","宇文","司徒","鲜于","司空","闾丘","子车","亓官","司寇","巫马","公西","颛孙","壤驷","公良","漆雕","乐正","宰父","谷梁","拓跋","夹谷","轩辕","令狐","段干","百里","呼延","东郭","南门","羊舌","微生","公户","公玉","公仪","梁丘","公仲","公上","公门","公山","公坚","左丘","公伯","西门","公祖","第五","公乘","贯丘","公晳","南荣","东里","东宫","仲长","子书","子桑","即墨","达奚","褚师","吴铭"],d=function(e){if(!e||1===e.length)return{firstName:e,name:e,fullName:e};if(2===e.length)return i.includes(e)?{firstName:e,name:"",fullName:e}:{firstName:e.slice(0,1),name:e.slice(1),fullName:e};if(e.length>=3){var n=e.slice(0,2);return i.includes(n)?{firstName:n,name:e.slice(2),fullName:e}:{firstName:e.slice(0,1),name:e.slice(1),fullName:e}}}},94699:function(e,n,t){t.d(n,{A:function(){return I}});var i=function(){var e=this,n=e._self._c;return n("div",{staticClass:"root"},e._l(e.nodes,function(t){return n("tree-node",{key:t.id,attrs:{node:t,"checked-keys":e.checkedKeys,last:!0,index:0,"expanded-keys":e.expandedKeys,"selected-key":e.selectedKey,"no-add":e.noAdd,"no-wife":e.noWife,"no-show-rank":e.noShowRank,"no-show-person-icon":e.noShowPersonIcon},on:{check:e.handleCheck,expand:e.handleExpand,click:e.handleNodeClick,wifeClick:e.handleWifeClick,addBrother:e.handleAddBrother,addChild:e.handleAddChild}})}),1)},d=[],a=t(43476),r=(t(88116),t(17121),t(78571),t(22282),t(35415),t(79640),t(16663),function(){var e,n=this,t=n._self._c;return t("div",{class:n.getCurrentClass()},[t("div",{staticClass:"border-left",class:n.getStyleNumClass()}),t("div",{staticClass:"item",staticStyle:{"margin-left":"0px"}},[n._m(0),t("div",{staticClass:"switch cus-edit-toolbar-icon",class:n.getExpandIconClass(),on:{click:function(e){return e.stopPropagation(),n.toggleExpand.apply(null,arguments)}}}),t("div",{staticClass:"padding",staticStyle:{width:"89px"}},[t("div",{staticClass:"line",class:n.getStyleNumClass()}),n.showSelectedICon?t("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarxuanze c-pointer-hover ml4"}):n._e(),t("span",[n._v("["+n._s(n.node.generation)+"世]")])]),t("div",{staticClass:"name",class:n.selectedKey===n.node.id?"selected":""},[n.noShowPersonIcon?n._e():t("i",{staticClass:"cus-edit-toolbar-icon",class:n.getPersonIconClass(n.node.sex),staticStyle:{"font-size":"16px"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===n.node.writeMode,expression:"node.writeMode === 2"}],staticClass:"text",on:{click:n.handleNodeClick}},[t("button",{staticClass:"btn-name"},[t("span",[n._v(n._s(n.node.first_name))]),t("span",[n._v(n._s(n.node.name))])])]),n.noAdd||1!==n.node.writeMode?n._e():t("div",{staticClass:"text mode-1"},[t("a-input",{attrs:{size:"small"},on:{pressEnter:n.handleSaveChildren,blur:n.handleSaveChildren},model:{value:n.childName,callback:function(e){n.childName=e},expression:"childName"}}),t("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarshanchu1 c-pointer-hover",attrs:{title:"删除该项"},on:{click:n.handleDelChildren}})],1),n.noShowRank?n._e():t("span",[n._v("["+n._s(n.node.ranking_text)+"]")]),n._l((null===(e=n.node)||void 0===e?void 0:e.wife)||[],function(e,i){return n.noWife?n._e():t("div",{key:e.id,staticClass:"name wife-item",class:n.selectedKey===e.id?"selected wife-selected":"",style:{marginTop:i>0?"4px":"0"},on:{click:function(t){return n.handleWifeClick(e)}}},[t("i",{staticClass:"cus-edit-toolbar-icon",class:n.getPersonIconClass(e.sex)}),t("div",{staticClass:"wife-content"},[t("span",{staticClass:"wife-text"},[n._v(n._s(e.full_name||""))])])])}),!n.noAdd&&(n.selectedKey===n.node.id||n.node.wife&&n.node.wife.some(function(e){return e.id===n.selectedKey}))?t("div",{staticClass:"name"},[t("i",{directives:[{name:"show",rawName:"v-show",value:n.isAddWife,expression:"isAddWife"}],staticClass:"cus-edit-toolbar-icon",class:n.getSpouseIconClass(),staticStyle:{"font-size":"14px"}}),t("a-input",{directives:[{name:"show",rawName:"v-show",value:n.isAddWife,expression:"isAddWife"}],staticStyle:{width:"80px","margin-right":"10px"},attrs:{size:"small"},on:{pressEnter:n.handleSaveWife,blur:n.handleSaveWife},model:{value:n.wifeName,callback:function(e){n.wifeName="string"===typeof e?e.trim():e},expression:"wifeName"}}),t("i",{directives:[{name:"show",rawName:"v-show",value:n.isAddWife,expression:"isAddWife"}],staticClass:"cus-edit-toolbar-icon icon-edit-toolbarshanchu1 c-pointer-hover",attrs:{title:"删除该项"},on:{click:n.handleDelWife}}),t("i",{directives:[{name:"show",rawName:"v-show",value:!n.isAddWife,expression:"!isAddWife"}],staticClass:"cus-edit-toolbar-icon",class:n.getSpouseIconClass(),staticStyle:{"font-size":"14px"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:!n.isAddWife,expression:"!isAddWife"}],staticClass:"more-wife",on:{click:function(e){n.isAddWife=!0}}},[n._v("添加配偶")])],1):n._e(),n.node.branch_tag?t("div",{staticClass:"name-top"},[t("span",{staticClass:"tag"},[n._v(n._s(n.getTagName(n.node.branch_tag)))]),t("span",{staticClass:"branch"},[n._v("["+n._s(n.node.branch_name)+"]")])]):n._e()],2)]),n.expanded&&n.node.children&&n.node.children.length?t("div",{staticClass:"children",class:n.selectedKey===n.node.id?"selected-node":""},[t("div",{staticStyle:{"margin-left":"0px"}},n._l(n.node.children,function(e,i){return t("tree-node",{key:e.id,attrs:{node:e,"checked-keys":n.checkedKeys,"expanded-keys":n.expandedKeys,"selected-key":n.selectedKey,index:n.index+1,last:i===n.node.children.length-1,fatherNode:n.node,"no-add":n.noAdd,"no-wife":n.noWife,"no-show-rank":n.noShowRank,"no-show-person-icon":n.noShowPersonIcon},on:{check:n.$listeners.check,expand:n.$listeners.expand,click:n.$listeners.click,wifeClick:n.$listeners.wifeClick,addBrother:n.$listeners.addBrother,addChild:n.$listeners.addChild}})}),1)]):n._e(),!n.noAdd&&n.shouldShowAddChild?t("div",{staticClass:"more-child",staticStyle:{"margin-left":"0px"}},[t("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarnance"}),t("div",{staticClass:"text",on:{click:n.handleAddChild}},[n._v("添加孩子")])]):n._e(),!n.noAdd&&n.shouldShowAddBrother?t("div",{staticClass:"more-child more-brother",staticStyle:{"margin-left":"0px"}},[t("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarnance"}),t("div",{staticClass:"text",on:{click:n.handleAddBrother}},[n._v("添加兄妹")])]):n._e()])}),s=[function(){var e=this,n=e._self._c;return n("div",{staticClass:"before"},[n("i",{staticClass:"icon",attrs:{title:"无编辑权限"}})])}];t(98308);function o(e,n){if(null==e)return{};var t={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==n.indexOf(i))continue;t[i]=e[i]}return t}function c(e,n){if(null==e)return{};var t,i,d=o(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(d[t]=e[t])}return d}var l=t(55736),h=t(40400),u=t(60990),f=(t(28129),t(13055),t(6082),t(34767),t(22098),t(65611),t(50651)),p=t(69475),m=t(24377),v=t(44586),y=t(11637),g=["id","key","uniqueId","isTemporary","title","children","wife"],k={name:"TreeNode",inheritAttrs:!1,props:{node:{type:Object,required:!0},fatherNode:{type:Object,default:function(){}},expandedKeys:{type:Array,default:function(){return[]}},checkedKeys:{type:Array,default:function(){return[]}},index:{type:Number,default:0},last:{type:Boolean,default:!1},selectedKey:{type:[Number,String],default:-9999},showSelectedICon:{type:Boolean,default:!1},noAdd:{type:Boolean,default:!1},noWife:{type:Boolean,default:!1},noShowRank:{type:Boolean,default:!1},noShowPersonIcon:{type:Boolean,default:!1}},data:function(){return{wifeName:"",isAddWife:!1,childName:this.node.first_name,expanded:this.expandedKeys.includes(this.node.key),checked:!1,hasBeenExpanded:!1,isLoadingChildren:!1}},computed:(0,u.A)((0,u.A)({},(0,f.aH)({quickOperationsType:function(e){return e.px.quickOperationsType},currentPedigreeMemberList:function(e){return e.px.currentPedigreeMemberList},currentSelectedClanId:function(e){return e.family.currentSelectedClanId},currentSelectedPedigreeId:function(e){return e.px.currentSelectedPedigreeId}})),{},{shouldShowAddChild:function(){var e=this;if(this.selectedKey===this.node.id)return!0;if(this.node.wife&&this.node.wife.length>0){var n=this.node.wife.find(function(n){return n.id===e.selectedKey});if(n)return!0}return!1},shouldShowAddBrother:function(){return this.selectedKey===this.node.id}}),watch:{expandedKeys:{handler:function(e){this.expanded=e.includes(this.node.key)},immediate:!0},checkedKeys:{handler:function(e){this.checked=e.includes(this.node.key)},immediate:!0},quickOperationsType:{handler:function(e){if(e&&this.node.id===this.selectedKey)switch(this.ResetQuickOperationsType(),e){case v.PX_RIGHT_OPTION_ADD_BROTHER:this.handleAddBrother();break;case v.PX_RIGHT_OPTION_ADD_CHILD:this.handleAddChild();break;case v.PX_RIGHT_OPTION_ADD_WIFE:this.isAddWife=!0;break}},immediate:!0}},methods:(0,u.A)((0,u.A)({},(0,f.i0)(["AddMemberChild","AddWife","SetLoading","ResetLoading","RefreshPedigreeMemberList","RefreshPedigreeMemberListKeepExpanded","LoadAndAppendChildGenerations","RefreshParentNodeChildren","ResetQuickOperationsType"])),{},{toggleExpand:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){var t,i;return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:if(!e.isLoadingChildren){n.n=1;break}return n.a(2);case 1:if(!e.expanded){n.n=3;break}if(1!==e.node.has_child||e.node.children&&0!==e.node.children.length){n.n=2;break}n.n=3;break;case 2:return e.expanded=!1,e.$emit("expand",e.node.key,e.expanded),n.a(2);case 3:if(t=e.shouldLoadChildren(),!t){n.n=7;break}return n.p=4,n.n=5,e.loadAndAppendChildGenerations();case 5:e.hasBeenExpanded=!0,n.n=7;break;case 6:return n.p=6,i=n.v,i.message&&i.message.includes("Cannot read properties of undefined")?e.$message.error("数据格式错误，请刷新页面后重试"):e.$message.error("加载子节点数据失败，请重试"),n.a(2);case 7:e.expanded=!0,e.hasBeenExpanded=!0,e.$emit("expand",e.node.key,e.expanded);case 8:return n.a(2)}},n,null,[[4,6]])}))()},shouldLoadChildren:function(){if(this.isLoadingChildren)return!1;if(0===this.node.has_child)return!1;if(1===this.node.has_child){if(!this.node.children||0===this.node.children.length)return!0;var e=this.node.children.length>0&&this.node.children.some(function(e){return void 0!==e.id&&null!==e.id});return!e}return!(this.node.children&&this.node.children.length>0)&&!this.hasBeenExpanded},loadAndAppendChildGenerations:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){var t,i;return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:if(!e.isLoadingChildren){n.n=1;break}return n.a(2);case 1:return n.p=1,e.isLoadingChildren=!0,t=e.LoadAndAppendChildGenerations,n.n=2,t({parentNodeId:e.node.id});case 2:e.node.children&&0!==e.node.children.length?e.node.has_child=1:e.node.has_child=0,e.syncExpandedState(),n.n=4;break;case 3:throw n.p=3,i=n.v,i;case 4:return n.p=4,e.isLoadingChildren=!1,n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])}))()},updateNodeWithRealId:function(){var e=this;if(this.fatherNode&&this.fatherNode.children){var n=this.fatherNode.children.find(function(n){return n.name===e.node.name&&n.full_name===e.node.full_name&&n.ranking===e.node.ranking&&!n.id.toString().startsWith("temp_")});n&&(this.node.id=n.id,this.node.key=n.key,delete this.node.isTemporary,delete this.node.uniqueId)}},handleNodeClick:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:return e.$emit("click",e.node.id,e.node),n.n=1,e.autoExpandIfHasChildren();case 1:return n.a(2)}},n)}))()},autoExpandIfHasChildren:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){var t,i,d,a,r;return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:if(t=e.couldHaveChildren(),!t){n.n=6;break}if(n.p=1,i=e.shouldLoadChildren(),!i){n.n=3;break}return d=e.node.id,a=e.node,n.n=2,e.loadAndAppendChildGenerations();case 2:r=e.node.children&&e.node.children.length>0,r&&(e.expanded||(e.expanded=!0,e.hasBeenExpanded=!0,e.$emit("expand",e.node.key,e.expanded)),e.$nextTick(function(){e.$emit("click",d,a)})),n.n=4;break;case 3:e.node.children&&e.node.children.length>0&&(e.expanded||(e.expanded=!0,e.hasBeenExpanded=!0,e.$emit("expand",e.node.key,e.expanded)));case 4:n.n=6;break;case 5:n.p=5,n.v,e.$message.error("自动展开节点失败，请手动点击展开");case 6:return n.a(2)}},n,null,[[1,5]])}))()},handleWifeClick:function(e){var n=(0,u.A)((0,u.A)({},e),{},{husband_id:this.node.id,generation:this.node.generation,father_id:0});this.$emit("wifeClick",e.id,n)},getTagName:function(e){return y.r[e]},handleAddBrother:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){var t,i,d,r,s,o,c;return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:if(e.fatherNode){n.n=1;break}return e.$message.error("始祖节点不能添加兄弟节点"),n.a(2);case 1:t=e.fatherNode,i=t.id,d=t.generation,r=e.fatherNode.first_name,e.fatherNode.children||(e.fatherNode.children=[]),s=e.fatherNode.children,o=e.fatherNode.children.length>0?Math.max.apply(Math,(0,a.A)(e.fatherNode.children.map(function(e){return e.ranking})))+1:1,c="temp_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,11)),s.push({clan_id:e.currentSelectedClanId,pedigree_id:e.currentSelectedPedigreeId,id:c,key:c,first_name:r,name:"",sex:"男",relation:"生",children:[],status:0,fatherId:i,motherId:-1,uniqueId:c,generation:d+1,ranking:o,writeMode:1,main:!0,limit:0,isTemporary:!0}),s.length&&!e.expanded&&(e.expanded=!e.expanded),e.$emit("addBrother",e.node.id,e.node);case 2:return n.a(2)}},n)}))()},handleAddChild:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){var t,i,d,r,s,o,c,h,u;return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:if(t=e.node,i=-1,e.node.wife&&e.node.wife.length>0&&(d=e.node.wife.find(function(n){return n.id===e.selectedKey}),d&&(i=d.id)),r=t.id,s=t.generation,o=t.first_name,"string"!==typeof r||!r.startsWith("temp_")){n.n=1;break}return e.$message.error("请先保存当前节点，再添加子节点"),n.a(2);case 1:t.children||(t.children=[]),c=t.children,h=c.length>0?Math.max.apply(Math,(0,a.A)(c.map(function(e){return e.ranking})))+1:1,u="temp_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,11)),c.push({clan_id:e.currentSelectedClanId,pedigree_id:e.currentSelectedPedigreeId,id:u,key:u,first_name:o,name:"",sex:"男",relation:"生",children:[],status:0,fatherId:r,motherId:i,uniqueId:u,generation:s+1,ranking:h,ranking_text:(0,m.g)(h),writeMode:1,main:!0,limit:0,living_status:1,isTemporary:!0}),c.length&&!e.expanded&&(e.expanded=!e.expanded),e.$emit("addChild",t.id,t);case 2:return n.a(2)}},n)}))()},handleSaveChildren:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){var t,i,d,a,r,s,o,h,f,v,y,k,_;return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:if(e.childName&&e.childName.trim()){n.n=1;break}return n.a(2);case 1:if(t=e.AddMemberChild,i=e.SetLoading,d=e.ResetLoading,a=(0,p._)(e.childName.trim()),r=a.firstName,s=a.name,o=a.fullName,e.node.writeMode=2,e.node.name=s,e.node.full_name=o,e.node.ranking_text=(0,m.g)(e.node.ranking),h=e.node,h.id,h.key,h.uniqueId,h.isTemporary,h.title,h.children,h.wife,f=c(h,g),v=e.node.fatherId,"string"!==typeof v||!v.startsWith("temp_")){n.n=3;break}if(!e.fatherNode||!e.fatherNode.id||e.fatherNode.id.toString().startsWith("temp_")){n.n=2;break}v=e.fatherNode.id,n.n=3;break;case 2:return e.$message.error("请先保存父节点，再添加子节点"),n.a(2);case 3:return y=(0,u.A)((0,u.A)({},f),{},{first_name:r,fatherId:v}),i(!0),n.p=4,n.n=5,t(y);case 5:if(k=n.v,200!==(null===k||void 0===k?void 0:k.code)){n.n=12;break}if(e.$message.success("添加成功"),n.p=6,_=v,!_){n.n=8;break}return n.n=7,e.RefreshParentNodeChildren({parentNodeId:_});case 7:e.updateNodeWithRealId(),e.fatherNode&&!e.fatherNode.expanded&&e.$emit("expand",e.fatherNode.key,!0),n.n=9;break;case 8:return n.n=9,e.RefreshPedigreeMemberListKeepExpanded();case 9:n.n=11;break;case 10:n.p=10,n.v,e.$message.warning("添加成功，但刷新数据失败，请手动刷新页面");case 11:n.n=13;break;case 12:e.$message.error((null===k||void 0===k?void 0:k.message)||"添加失败");case 13:n.n=15;break;case 14:n.p=14,n.v,e.$message.error("添加失败");case 15:return n.p=15,d(),n.f(15);case 16:return n.a(2)}},n,null,[[6,10],[4,14,15,16]])}))()},handleSaveWife:function(){var e=this;return(0,h.A)((0,l.A)().m(function n(){var t,i,d,r,s,o,c,h,u,f,m,v,y,g,k,_,x;return(0,l.A)().w(function(n){while(1)switch(n.n){case 0:if(e.wifeName&&e.wifeName.trim()){n.n=1;break}return n.a(2);case 1:return t=e.AddWife,i=e.wifeName,d=e.SetLoading,r=e.ResetLoading,s=e.node,o=s.id,c=s.generation,h=e.node.wife?e.node.wife:[],u=h.length>0?Math.max.apply(Math,(0,a.A)(h.map(function(e){return e.ranking})))+1:1,f=(0,p._)(i.trim()),m=f.firstName,v=f.name,y=f.fullName,g="女"===e.node.sex?"男":"女",k="女"===g?"长女":"长子",_={clan_id:e.currentSelectedClanId,pedigree_id:e.currentSelectedPedigreeId,generation:c,first_name:m,name:v,full_name:y,ranking:u,ranking_text:k,relation:"配",sex:g,husband_id:o},d(!0),n.p=2,n.n=3,t(_);case 3:if(x=n.v,200!==(null===x||void 0===x?void 0:x.code)){n.n=8;break}return e.$message.success("添加配偶成功"),e.isAddWife=!1,e.wifeName="",n.p=4,n.n=5,e.RefreshPedigreeMemberListKeepExpanded();case 5:n.n=7;break;case 6:n.p=6,n.v,e.$message.warning("添加配偶成功，但刷新数据失败，请手动刷新页面");case 7:e.$emit("click",e.node.id,e.node),n.n=9;break;case 8:e.$message.error((null===x||void 0===x?void 0:x.message)||"添加配偶失败");case 9:n.n=11;break;case 10:n.p=10,n.v,e.$message.error("添加配偶失败");case 11:return n.p=11,r(),n.f(11);case 12:return n.a(2)}},n,null,[[4,6],[2,10,11,12]])}))()},handleDelChildren:function(){var e=this,n=this.fatherNode.children;1===n.length?this.fatherNode.children=[]:this.fatherNode.children=n.filter(function(n){return n.id!==e.node.id})},getCurrentClass:function(){var e="";e+="node ",this.node.children&&this.expanded&&(e+="expand "),e+="border ";var n=this.node.children&&this.node.children.length>0,t=this.couldHaveChildren();return n||t||(e+="no-children "),this.last&&(e+="last-item "),e},couldHaveChildren:function(){if(void 0!==this.node.has_child&&null!==this.node.has_child){var e=this.node.has_child,n=!1;return"boolean"===typeof e?n=e:"string"===typeof e?n="1"===e||"true"===e.toLowerCase():"number"===typeof e&&(n=1===e),n}return!!(this.node.children&&this.node.children.length>0)},getExpandIconClass:function(){if(this.isLoadingChildren)return"icon-edit-toolbarjia loading";var e=this.node.children&&this.node.children.length>0;return this.expanded&&e?"icon-edit-toolbarjian":1===this.node.has_child?e&&this.expanded?"icon-edit-toolbarjian":"icon-edit-toolbarjia":e?this.expanded?"icon-edit-toolbarjian":"icon-edit-toolbarjia":""},syncExpandedState:function(){this.expanded&&!this.expandedKeys.includes(this.node.key)?this.$emit("expand",this.node.key,!0):!this.expanded&&this.expandedKeys.includes(this.node.key)&&this.$emit("expand",this.node.key,!1)},getStyleNumClass:function(){var e="";return this.last&&(e+="style-".concat(0===this.index?"0":"1"," ")),this.selectedKey===this.node.fatherId&&this.expanded&&this.last&&(e+="style-2 "),e},getItemClass:function(){var e,n="node border";return this.last&&(n+=" last-item"),0===(null===(e=this.node.children)||void 0===e?void 0:e.length)&&(n+=" no-children"),n},handleDelWife:function(){this.isAddWife=!1},getPersonIconClass:function(e){return"女"===e?"icon-edit-toolbarnvce wife-icon":"icon-edit-toolbarnance"},getSpouseIconClass:function(){var e="女"===this.node.sex?"男":"女";return this.getPersonIconClass(e)}})},_=k,x=t(20899),C=(0,x.A)(_,r,s,!1,null,"3d7a569c",null),A=C.exports,w={name:"AntTree",components:{TreeNode:A},props:{nodes:{type:Array,default:function(){return[]}},checkable:{type:Boolean,default:!1},defaultExpandedKeys:{type:Array,default:function(){return[]}},defaultCheckedKeys:{type:Array,default:function(){return[]}},selectedKey:{type:[Number,String],default:""},noAdd:{type:Boolean,default:!1},noWife:{type:Boolean,default:!1},noShowRank:{type:Boolean,default:!1},noShowPersonIcon:{type:Boolean,default:!1}},data:function(){return{list:[],expandedKeys:(0,a.A)(this.defaultExpandedKeys),checkedKeys:(0,a.A)(this.defaultCheckedKeys)}},watch:{nodes:{handler:function(e){this.list=e},immediate:!0,deep:!0},defaultExpandedKeys:{handler:function(e){this.expandedKeys=e},immediate:!0,deep:!0},defaultCheckedKeys:{handler:function(e){this.checkedKeys=e},immediate:!0,deep:!0}},methods:{handleExpand:function(e,n){var t=this.expandedKeys.indexOf(e);n&&-1===t?this.expandedKeys.push(e):n||-1===t||this.expandedKeys.splice(t,1),this.$emit("expand",this.expandedKeys)},handleCheck:function(e,n){if(n)this.checkedKeys.includes(e)||this.checkedKeys.push(e);else{var t=this.checkedKeys.indexOf(e);-1!==t&&this.checkedKeys.splice(t,1)}this.$emit("check",this.checkedKeys)},handleNodeClick:function(e,n){this.$emit("click",e,n)},handleWifeClick:function(e,n){this.$emit("wifeClick",e,n)},handleAddBrother:function(e,n){this.$emit("addBrother",e,n)},handleAddChild:function(e,n){this.$emit("addChild",e,n)}}},b=w,N=(0,x.A)(b,i,d,!1,null,"8137040e",null),I=N.exports}}]);