"use strict";(self["webpackChunkvue_antd_pro"]=self["webpackChunkvue_antd_pro"]||[]).push([[302],{43476:function(t,e,i){i.d(e,{A:function(){return l}});var a=i(3577);function n(t){if(Array.isArray(t))return(0,a.A)(t)}i(98308),i(93116),i(44266),i(6413),i(79640),i(24897),i(22432);function r(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var s=i(47991);function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return n(t)||r(t)||(0,s.A)(t)||o()}},56026:function(t,e,i){t.exports=i.p+"img/cover-list2.07059957.png"},59023:function(t,e,i){i.d(e,{A:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("a-cascader",{attrs:{"field-names":{label:"name",value:"name",children:"child"},options:t.options,value:t.value,"change-on-select":"",placeholder:"请选择","load-data":t.loadData},on:{change:t.onChange}})},n=[],r=i(43476),s=i(55736),o=i(40400),l=(i(88116),i(34767),i(18433),i(35415),i(79640),i(94354)),c=["北京","天津","上海","重庆"],u={data:function(){return{options:[],value:this.initValue||[]}},watch:{initValue:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.value=t}},props:{initValue:{type:Array,default:function(){return[]}}},mounted:function(){this.getprovince()},methods:{getprovince:function(){var t=this;return(0,o.A)((0,s.A)().m(function e(){var i,a,n;return(0,s.A)().w(function(e){while(1)switch(e.n){case 0:return e.n=1,(0,l.Sr)({fid:4744});case 1:i=e.v,a=i.code,n=i.data,200===a&&(t.options=n.list.map(function(t){return{name:t.name,id:t.id,isLeaf:!1}}).sort(function(t,e){return t.id-e.id}));case 2:return e.a(2)}},e)}))()},loadData:function(t){var e=this;return(0,o.A)((0,s.A)().m(function i(){var a,n,o,u,d,p;return(0,s.A)().w(function(i){while(1)switch(i.n){case 0:return a=t[t.length-1],n=t.length,o=c.includes(a.name),a.loading=!0,i.n=1,(0,l.Sr)({fid:a.id});case 1:u=i.v,d=u.code,p=u.data,200===d&&(a.child=p.list.map(function(t){return{name:t.name,id:t.id,isLeaf:!!o||n>=2}}).sort(function(t,e){return t.id-e.id})),a.loading=!1,e.options=(0,r.A)(e.options);case 2:return i.a(2)}},i)}))()},onChange:function(t,e){this.value=t,this.$emit("change",t)}}},d=u,p=i(20899),m=(0,p.A)(d,a,n,!1,null,"5fd88b7e",null),h=m.exports},94354:function(t,e,i){i.d(e,{A2:function(){return d},F8:function(){return c},Sr:function(){return o},tD:function(){return m}});var a=i(55736),n=i(40400),r=i(32122),s={getAreaList:"/web/site/get-area-list",getDynastyData:"/web/site/date/dynasty-data",getYearDynastyDate:"/web/site/get-year-dynasty-date",getMonthData:"/web/site/date/lunar-month-data"};function o(t){return l.apply(this,arguments)}function l(){return l=(0,n.A)((0,a.A)().m(function t(e){return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:return t.a(2,(0,r.Ay)({url:s.getAreaList,method:"get",params:e}))}},t)})),l.apply(this,arguments)}function c(){return u.apply(this,arguments)}function u(){return u=(0,n.A)((0,a.A)().m(function t(){return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:return t.a(2,(0,r.Ay)({url:s.getDynastyData,method:"get"}))}},t)})),u.apply(this,arguments)}function d(t){return p.apply(this,arguments)}function p(){return p=(0,n.A)((0,a.A)().m(function t(e){return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:return t.a(2,(0,r.Ay)({url:s.getYearDynastyDate,method:"get",params:e}))}},t)})),p.apply(this,arguments)}function m(t){return h.apply(this,arguments)}function h(){return h=(0,n.A)((0,a.A)().m(function t(e){return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:return t.a(2,(0,r.Ay)({url:s.getMonthData,method:"get",params:e}))}},t)})),h.apply(this,arguments)}},99845:function(t,e,i){i.r(e),i.d(e,{default:function(){return z}});i(35415);var a=function(){var t=this,e=t._self._c;return e("a-spin",{attrs:{size:"large",spinning:t.loadPageData}},[e("div",{staticClass:"flex flex-direction-column ml6"},[e("div",{staticClass:"head"},[e("div",{staticClass:"flex"},[e("a-select",{staticStyle:{width:"140px"},model:{value:t.selectedGroupId,callback:function(e){t.selectedGroupId=e},expression:"selectedGroupId"}},[e("a-select-option",{attrs:{value:"all"}},[t._v("全部分组")]),t._l(t.groupList,function(i){return e("a-select-option",{key:i.id,attrs:{value:i.id}},[t._v(t._s(i.group_name))])})],2),e("span",{staticClass:"ml12 flex flex-direction-row align-center c-pointer-hover",on:{click:function(e){t.showGroupModal=!0}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbaryemian"}),t._v(" 分组管理 ")])],1),e("div",{staticClass:"flex-1 flex flex-direction-row justify-content-end"},[e("a-popover",{attrs:{placement:"bottom"}},[e("template",{slot:"content"},[e("div",{staticClass:"mt4",staticStyle:{width:"230px"}},[t._v("当前管理家族数量：1")]),e("div",{staticClass:"mt6"},[t._v("当管理家族数量上限：1")]),e("div",{staticClass:"flex bg-primary justify-content-space-between mt10",staticStyle:{padding:"4px 12px"}},[e("div",[t._v("专项版: 1")]),e("div",[t._v("额外: 0")])])]),e("div",{staticClass:"flex flex-direction-row align-center family-block"},[e("span",{staticClass:"mr4"},[t._v("家族管理")]),e("div",{staticClass:"flex f16",staticStyle:{width:"140px"}},[e("a-progress",{attrs:{"stroke-color":{"0%":"#f98b36","100%":"#f98b36"},percent:100},scopedSlots:t._u([{key:"format",fn:function(i){return[e("span",{staticClass:"primary"},[t._v("1")]),t._v("/1 ")]}}])})],1)])],2),e("div",{staticClass:"ml24"},[t._v("协管: "),e("span",{staticStyle:{color:"#b9a012"}},[t._v("0")])]),e("div",{staticClass:"ml24 mr16"},[t._v("协作: "),e("span",{staticStyle:{color:"#51b912"}},[t._v("0")])])],1)]),e("div",{staticClass:"main"},[t._l(t.filteredGroupList,function(a){return e("div",{key:a.id,staticClass:"section"},[e("div",{staticClass:"title"},[e("div",{staticClass:"left"},[e("span",[t._v(t._s(a.group_name||""))]),e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarxiugai c-999 c-pointer-hover",staticStyle:{"font-size":"16px"},attrs:{title:"编辑"}})]),e("div",{staticClass:"right"},[e("div",{staticClass:"item"},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarjia c-pointer-hover",staticStyle:{"font-size":"14px"},on:{click:function(e){return t.handleAdd(a)}}}),e("span",{staticClass:"ml6 txt",on:{click:function(e){return t.handleAdd(a)}}},[t._v("创建家族/家谱")])]),e("div",{staticClass:"item c-pointer-hover"},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarpaixu c-pointer-hover",staticStyle:{"font-size":"14px"},on:{click:t.handleFamilySort}}),e("span",{staticClass:"ml6 txt",on:{click:function(e){return t.handleFamilySort(a)}}},[t._v("家族排序")])])])]),e("div",{staticClass:"list"},[t._l(a.clan_list,function(n){return e("div",{key:n.id,staticClass:"item",class:"tag-guanli",on:{click:function(e){return t.handleClainSelected(a,n)}}},[e("div",{staticClass:"inner"},[e("div",{staticStyle:{width:"158px",height:"205px"}},[e("div",{staticClass:"cover-container",staticStyle:{transform:"scale(1.58)"},on:{click:function(e){return t.handleClainSelected(a,n,"px")}}},[e("img",{staticClass:"cover",attrs:{"data-v-0818750d":"",src:i(56026),alt:""}}),e("div",{staticClass:"title"},[e("div",{staticClass:"title2"},[e("div",{staticClass:"title3"},[e("div",{staticClass:"title4",staticStyle:{transform:"scale(0.56)"}},[t._v(t._s(n.name||""))])])])])])]),e("div",{staticClass:"title-name"},[e("div",{staticClass:"txt line-word"},[t._v(t._s(n.name||""))]),e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarxiugai c-pointer-hover",staticStyle:{"font-size":"18px"},on:{click:function(e){return t.handleEdit(a,n)}}})])]),e("div",{staticClass:"btn-v align-center"},[e("div",{staticClass:"btn c-pointer-hover",on:{click:function(e){return t.handleFamilyBaseInfo(a,n)}}},[t._v("家族信息")]),e("a-popover",{attrs:{placement:"rightBottom"}},[e("template",{slot:"content"},[e("div",[t._v("更多设置")]),e("div",{staticClass:"ml6 more-opt-btn-item",on:{click:function(e){return t.handleClainSelected(a,n,"px")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarnaotu mr6",staticStyle:{"font-size":"16px"}}),t._v("录入谱系 ")]),e("div",{staticClass:"ml6 more-opt-btn-item",on:{click:function(e){return t.handleClainSelected(a,n,"pw")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarzengjiawenzhang mr6",staticStyle:{"font-size":"16px"}}),t._v("编辑谱文 ")]),e("div",{staticClass:"ml6 more-opt-btn-item",on:{click:function(e){return t.handleClainSelected(a,n,"ps")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarshuben mr6",staticStyle:{"font-size":"16px"}}),t._v("制作谱书 ")]),e("div",{staticClass:"ml6 more-opt-btn-item",staticStyle:{display:"none"}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarmigrate mr6",staticStyle:{"font-size":"16px"}}),t._v("迁移分组 ")]),e("div",{staticClass:"ml6 more-opt-btn-item",on:{click:function(e){return t.handleDelete(a)}}},[t._v(" 删除 ")])]),e("div",{staticClass:"btn c-pointer-hover"},[t._v("更多设置")])],2)],1)])}),e("div",{staticClass:"item"},[e("div",{staticClass:"add",on:{click:function(e){return t.handleAdd(a)}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarjia2 primary",staticStyle:{"font-size":"30px"}}),e("div",{staticClass:"add-txt"},[t._v("创建家族/家谱")])])])],2)])}),0===t.groupList.length?e("div",{staticClass:"empty"},[e("a-empty")],1):t._e()],2),t.showEditFamilyModal?e("family-edit",{attrs:{type:t.familyType,id:t.familyEditId,groupId:t.familyGroupId},on:{close:t.handleCloseEditModal,refresh:t.refresh}}):t._e(),t.showFamilySort?e("family-sort",{attrs:{groupId:t.familyGroupId},on:{close:t.handleCloseFamilySort,refresh:t.refresh}}):t._e(),t.showFamilyBaseInfo?e("family-base",{on:{close:t.handleFamilyBaseInfo}}):t._e(),t.showGroupModal?e("add-group",{on:{"close-modal":function(e){t.showGroupModal=!1}}}):t._e()],1)])},n=[],r=i(55736),s=i(40400),o=i(43476),l=i(60990),c=(i(28129),i(6082),i(18433),i(79640),i(50651)),u=i(55126),d=i.n(u),p=function(){var t=this,e=t._self._c;return e("a-modal",{staticClass:"family-edit-modal-wrap",attrs:{title:"add"===t.type?"新增家族":"编辑家族"},on:{ok:t.handleOk,cancel:function(e){return t.$emit("close")}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("a-form",{attrs:{form:t.form,"label-col":{span:5},"wrapper-col":{span:18}},on:{submit:t.handleSubmit}},[e("a-form-item",{attrs:{label:"家族分组"}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["group_id",{rules:[{required:!0,message:"请选择家族分组!"}]}],expression:"['group_id', { rules: [{ required: true, message: '请选择家族分组!' }] }]"}],attrs:{placeholder:"请选择家族分组"}},t._l(t.groups,function(i){return e("a-select-option",{key:i.id,attrs:{value:i.id}},[t._v(t._s(i.group_name))])}),1)],1),e("a-form-item",{attrs:{label:"家族名称"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入家族名称!"}]}],expression:"['name', { rules: [{ required: true, message: '请输入家族名称!' }] }]"}],attrs:{placeholder:"请输入",maxLength:30}})],1),e("a-form-item",{attrs:{label:"家族姓氏"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["surname",{rules:[{required:!0,message:"请输入家族姓氏!"}]}],expression:"['surname', { rules: [{ required: true, message: '请输入家族姓氏!' }] }]"}],attrs:{placeholder:"请输入",maxLength:30}})],1),e("a-form-item",{attrs:{label:"始迁祖"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ancestor",{rules:[{required:!0,message:"请输入始迁祖!"}]}],expression:"['ancestor', { rules: [{ required: true, message: '请输入始迁祖!' }] }]"}],attrs:{placeholder:"请输入",maxLength:30}})],1),e("a-form-item",{attrs:{label:"堂号"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["hall_name",{rules:[{required:!1,message:"请输入堂号!"}]}],expression:"['hall_name', { rules: [{ required: false, message: '请输入堂号!' }] }]"}],attrs:{placeholder:"请输入",maxLength:30}})],1),e("a-form-item",{attrs:{label:"所在地区"}},[e("area-cascader",{directives:[{name:"decorator",rawName:"v-decorator",value:["province",{rules:[{required:!0,validator:t.checkPrice}]}],expression:"['province', { rules: [{ required: true, validator: checkPrice }] }]"}],attrs:{"init-value":t.initValue}})],1),e("a-form-item",{attrs:{label:"家族简介"}},[e("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description"],expression:"['description']"}],attrs:{"auto-size":{minRows:3,maxRows:3},placeholder:"请输入"}})],1),e("a-form-item",{attrs:{"wrapper-col":{span:12,offset:8}}},[e("a-button",{staticClass:"mr10",attrs:{type:"default"},on:{click:function(e){return t.$emit("close")}}},[t._v("取消")]),e("a-button",{attrs:{type:"primary","html-type":"submit"}},[t._v("确定")])],1)],1)],1)},m=[],h=(i(98308),i(93116),i(88116),i(78571),i(59023)),f=["北京","天津","上海","重庆"],v={name:"FamilyEditComponent",components:{AreaCascader:h.A},data:function(){return{submitting:!1,visible:!0,initValue:[],formLayout:"horizontal",form:this.$form.createForm(this,{name:"xxx"})}},computed:(0,l.A)({},(0,c.aH)({groups:function(t){return t.family.groups},groupClan:function(t){return t.family.groupClan}})),props:{id:{type:Number,default:0},type:{type:String,default:"edit"},groupId:{type:[String,Number],default:""}},mounted:function(){this.form.getFieldDecorator("group_id",{initialValue:this.groupId}),this.form.getFieldDecorator("province",{initialValue:void 0}),"edit"===this.type&&this.getData()},methods:(0,l.A)((0,l.A)({},(0,c.i0)(["AddClan"])),{},{getData:function(){var t=this,e=this.groupClan.find(function(e){return e.id===t.groupId});if(e){var i=e.clan_list.find(function(e){return"".concat(e.id)==="".concat(t.id)});if(i){var a=i.name,n=i.surname,r=i.ancestor,s=i.province,o=i.city,l=i.district,c=i.description;this.initValue=[s,o,l],this.form.getFieldDecorator("name",{initialValue:a}),this.form.getFieldDecorator("surname",{initialValue:n}),this.form.getFieldDecorator("ancestor",{initialValue:r}),this.form.getFieldDecorator("hall_name",{initialValue:i.hall_name}),this.form.getFieldDecorator("province",{initialValue:[s,o,l]}),this.form.getFieldDecorator("description",{initialValue:c||"这是简介"})}}},handleSubmit:function(t){var e=this;t.preventDefault();var i=this.AddClan;this.form.validateFields(function(){var t=(0,s.A)((0,r.A)().m(function t(a,n){var s,o,c,u,d;return(0,r.A)().w(function(t){while(1)switch(t.n){case 0:if(a){t.n=2;break}return s=(0,l.A)({},n),s.province=n.province[0],o=f.includes(n.province[0]),s.city=o?n.province[0]:n.province[1],s.district=o?n.province[1]:n.province[2]||"",s.group_id=parseInt(s.group_id),e.id&&(s.id=e.id),e.submitting=!0,t.n=1,i(s);case 1:c=t.v,u=c.code,d=c.message,200===u?(e.$message.success("操作成功"),e.submitting=!1,e.$emit("refresh"),e.$emit("close")):e.$message.error(d||"操作失败");case 2:return t.a(2)}},t)}));return function(e,i){return t.apply(this,arguments)}}())},handleOk:function(t){this.visible=!1},checkPrice:function(t,e,i){if(e&&e.length>0)i();else{var a="请选择所在地区!";i(a)}}})},g=v,y=i(20899),b=(0,y.A)(g,p,m,!1,null,"3f315225",null),C=b.exports,w=function(){var t=this,e=t._self._c;return e("a-modal",{staticClass:"family-sort-modal-wrap",attrs:{title:"家族排序",comformLoading:t.submitting},on:{ok:t.handleOk,cancel:function(e){return t.$emit("close")}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("div",{staticClass:"flex align-center justify-content-space-between",staticStyle:{padding:"10px 20px"}},[e("div",{staticClass:"flex align-center c-pointer-hover",on:{click:function(e){return t.handleMove("first")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarzhidingxian",staticStyle:{"font-size":"14px"}}),t._v("置顶")]),e("div",{staticClass:"flex align-center c-pointer-hover",on:{click:function(e){return t.handleMove("up")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarkongxinjiantou",staticStyle:{"font-size":"14px"}}),t._v("上移")]),e("div",{staticClass:"flex align-center c-pointer-hover",on:{click:function(e){return t.handleMove("down")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarkongxinjiantou1",staticStyle:{"font-size":"14px"}}),t._v("下移")]),e("div",{staticClass:"flex align-center c-pointer-hover",on:{click:function(e){return t.handleMove("last")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarzhidixian",staticStyle:{"font-size":"14px"}}),t._v("置底")])]),t._l(t.clanList,function(i){return e("div",{key:i.id,staticClass:"item",class:i.id===t.selectId?"active":"",on:{click:function(e){t.selectId=i.id}}},[t._v(t._s(i.name))])})],2)},_=[],x=(i(58423),{name:"FamilySortComponent",data:function(){return{visible:!0,clanList:[],selectId:"",submitting:!1}},computed:(0,l.A)({},(0,c.aH)({groupClan:function(t){return t.family.groupClan}})),watch:{groupClan:{handler:function(t){var e,i=this;this.clanList=(null===(e=t.find(function(t){return t.id===i.groupId}))||void 0===e?void 0:e.clan_list)||[]},immediate:!0}},props:{groupId:{type:[Number,String],default:""}},methods:(0,l.A)((0,l.A)({},(0,c.i0)(["GroupClanList","SaveGroup"])),{},{handleOk:function(t){var e=this;return(0,s.A)((0,r.A)().m(function t(){return(0,r.A)().w(function(t){while(1)switch(t.n){case 0:e.submitting=!0,e.visible=!1,e.submitting=!1,e.$emit("close"),e.$emit("refresh");case 1:return t.a(2)}},t)}))()},handleMove:function(t){var e=this;return(0,s.A)((0,r.A)().m(function i(){var a,n,s,o,l,c,u,p;return(0,r.A)().w(function(i){while(1)switch(i.n){case 0:if(e.selectId){i.n=1;break}return e.$message.error("请选择要操作的项"),i.a(2);case 1:a=e.clanList.findIndex(function(t){return t.id===e.selectId}),n=e.clanList,s=n.length,p=t,i.n="up"===p?2:"down"===p?3:"first"===p?4:"last"===p?5:6;break;case 2:return a>0&&(o=[n[a],n[a-1]],n[a-1]=o[0],n[a]=o[1]),i.a(3,6);case 3:return a<n.length-1&&(l=[n[a],n[a+1]],n[a+1]=l[0],n[a]=l[1]),i.a(3,6);case 4:return c=[n[a],n[0]],n[0]=c[0],n[a]=c[1],i.a(3,6);case 5:return u=[n[a],n[s-1]],n[s-1]=u[0],n[a]=u[1],i.a(3,6);case 6:e.clanList=d()(n);case 7:return i.a(2)}},i)}))()}})}),A=x,S=(0,y.A)(A,w,_,!1,null,null,null),k=S.exports,L=i(48179),I=JSON.parse('{"p":[{"id":15775,"name":"我的家族","sort":1,"isExample":0,"projectList":[]},{"id":29509,"name":"这是一个分组","sort":2,"isExample":0,"projectList":[{"id":"yjEYWhDelfoi8","type":1,"name":"江都堂董氏江夏支谱","showName":"江都堂董氏江夏支谱","ancestor":"益三公","firstName":"董","hall":"江都塘","province":"湖南省","city":"永州市","district":"新田县","description":"","wxQrCode":"https://cdn.baijiayoupu.com/api/images/qr/project/wechat/76277.png","appQrCode":"https://cdn.baijiayoupu.com/api/images/qr/project/app/76277.png","h5Preview":"https://cdn.baijiayoupu.com/api/images/qr/firstName/h5/董.png","isExample":0,"isTeam":0,"isManage":0,"permission":null,"groupId":29509,"sort":1,"adminId":466784,"adminName":"150***590","adminPhone":"150********590","memberLimit":0,"memberCount":23409,"mappingMode":null,"clanBuyLimit":4,"projectNumber":null,"level":{"id":8,"name":"专享版","clanLimit":1,"clanMemberLimit":0,"projectLimit":1,"fileLimit":300,"printPlanLimit":5,"printSampleLimit":3,"printFreeCount":0,"printPayType":1,"printPrice":100,"printFreeQuota":0,"discount":0,"commissionRatio":0,"previewPrice":0,"printPeoplePrice":80,"previewPeoplePrice":0,"isAgent":0,"viewCpgBookCount":0,"projectBuySwitch":true,"clanBuySwitch":true,"clanArticleLimit":100,"printSampleSwitch":true,"printDownloadSwitch":true,"printPdfSwitch":false,"printPublishSwitch":true,"reelCreateLimit":3,"reelGenerateLimit":3,"reelGenerateSwitch":true,"reelDownloadSwitch":true,"reelHdgenerateSwitch":false,"reelHdgeneratePrice":80,"managerLimit":2,"collaboratorLimit":5,"collectorLimit":5,"expireTime":"长期"}}]},{"id":-1,"name":"优秀范例","sort":0,"isExample":1,"projectList":[{"id":"9118","type":0,"name":"莲山谱牒范例","showName":"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t莲山谱牒范例","ancestor":"聚元","firstName":"杨","hall":"","province":"广东省","city":"广州市","district":"番禺区","description":"莲山谱牒家族范例","wxQrCode":"https://cdn.baijiayoupu.com/api/images/qr/project/wechat/9118.png","appQrCode":"https://cdn.baijiayoupu.com/api/images/qr/project/app/9118.png","h5Preview":"https://cdn.baijiayoupu.com/api/images/qr/firstName/h5/杨.png","isExample":1,"isTeam":0,"isManage":0,"permission":null,"groupId":21309,"sort":3,"adminId":7924,"adminName":"厚德载物","adminPhone":"158********908","memberLimit":0,"memberCount":54,"mappingMode":null,"clanBuyLimit":0,"projectNumber":"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t","level":{"id":8,"name":"专享版","clanLimit":1,"clanMemberLimit":0,"projectLimit":1,"fileLimit":300,"printPlanLimit":5,"printSampleLimit":3,"printFreeCount":0,"printPayType":1,"printPrice":100,"printFreeQuota":0,"discount":0,"commissionRatio":0,"previewPrice":0,"printPeoplePrice":80,"previewPeoplePrice":0,"isAgent":0,"viewCpgBookCount":0,"projectBuySwitch":true,"clanBuySwitch":true,"clanArticleLimit":100,"printSampleSwitch":true,"printDownloadSwitch":true,"printPdfSwitch":false,"printPublishSwitch":true,"reelCreateLimit":3,"reelGenerateLimit":3,"reelGenerateSwitch":true,"reelDownloadSwitch":true,"reelHdgenerateSwitch":false,"reelHdgeneratePrice":80,"managerLimit":2,"collaboratorLimit":5,"collectorLimit":5,"expireTime":"长期"}}]}]}'),F=(i(16663),function(){var t=this,e=t._self._c;return e("a-modal",{staticClass:"add-group",attrs:{title:"分组管理",confirmLoading:t.submitting},on:{ok:t.handleOk,cancel:function(e){return t.$emit("close-modal")}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("a-spin",{attrs:{spinning:t.loading}},[e("div",{staticClass:"flex opt align-center"},[e("div",{staticClass:"flex-1 align-center"},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarjia c-pointer-hover",on:{click:t.handleAdd}}),e("span",{staticClass:"c-pointer-hover",on:{click:t.handleAdd}},[t._v("新增分组")])]),e("div",{staticClass:"flex"},[e("div",{staticClass:"c-pointer-hover",on:{click:function(e){return t.handleMove("up")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarkongxinjiantou c-pointer-hover"}),e("span",{staticClass:"c-pointer-hover"},[t._v("上移")])]),e("div",{staticClass:"c-pointer-hover",on:{click:function(e){return t.handleMove("down")}}},[e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarkongxinjiantou1 c-pointer-hover"}),e("span",{staticClass:"c-pointer-hover"},[t._v("下移")])])])]),e("div",{staticClass:"content mt12"},[t._l(t.list,function(i){return e("div",{key:i.id,staticClass:"item",class:i.id===t.selectedId?"selected":"",on:{click:function(e){t.selectedId=i.id}}},[i.editing?e("a-input",{attrs:{type:"text",placeholder:"请输入",maxLength:20},model:{value:i.group_name,callback:function(e){t.$set(i,"group_name","string"===typeof e?e.trim():e)},expression:"item.group_name"}}):e("span",{staticClass:"flex-1"},[t._v(t._s(i.group_name))]),i.editing?e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarduigou c-pointer-hover ml12 f28",on:{click:function(e){return t.handleSaveEdit(i)}}}):t._e(),i.editing?e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarcuo c-pointer-hover ml12 f28",on:{click:function(e){return t.handleSaveEdit(i)}}}):t._e(),i.editing?t._e():e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarxiugai c-pointer-hover",on:{click:function(e){return t.handleEdit(i)}}}),i.editing?t._e():e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarshanchu1 c-pointer-hover delete",on:{click:function(e){return t.handleDelete(i.id)}}})],1)}),t.isEdit?e("div",{staticClass:"item input-item"},[e("a-input",{attrs:{type:"text",placeholder:"请输入",maxLength:20},model:{value:t.groupName,callback:function(e){t.groupName="string"===typeof e?e.trim():e},expression:"groupName"}}),e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarduigou c-pointer-hover ml12 f28",on:{click:t.save}}),e("i",{staticClass:"cus-edit-toolbar-icon icon-edit-toolbarcuo c-pointer-hover ml12 f28",on:{click:t.handleCancel}})],1):t._e(),0!==t.list.length||t.isEdit?t._e():e("div",{staticClass:"empty"},[e("a-empty")],1)],2)])],1)}),G=[],D=(i(13055),i(34767),i(97693),{name:"AddGroup",data:function(){return{visible:!0,groupName:"",isEdit:!1,loading:!1,submitting:!1,selectedId:-999,list:[]}},computed:(0,l.A)({},(0,c.aH)({groups:function(t){return t.family.groups},hasLoadedGroup:function(t){return t.family.hasLoadedGroup}})),watch:{groups:function(t,e){this.list=d()(t).sort(function(t,e){return t.sort_order-e.sort_order})}},mounted:function(){var t=this;return(0,s.A)((0,r.A)().m(function e(){return(0,r.A)().w(function(e){while(1)switch(e.n){case 0:if(t.loading=!0,t.hasLoadedGroup){e.n=1;break}return e.n=1,t.GroupClanList();case 1:t.loading=!1;case 2:return e.a(2)}},e)}))()},methods:(0,l.A)((0,l.A)({},(0,c.i0)(["SaveGroup","GroupClanList"])),{},{check:function(){var t=this.list.filter(function(t){return t.editing});return t.length>0?(this.$message.error("请先保存正在编辑信息"),!1):!this.isEdit||(this.$message.error("请先保存分组"),!1)},handleAdd:function(){this.check()&&(this.isEdit=!0)},handleOk:function(){var t=this;if(this.list.length>0){if(this.submitting)return void this.$message.success("处理中请稍后");this.submitting=!0,this.SaveGroup({list:this.list}).then(function(e){t.submitting=!1,200===e.code?(t.GroupClanList(),t.$message.success("保存成功"),t.visible=!1,t.$emit("close-modal")):t.$message.success(e.message)})}else this.$message.error("请录入分组")},save:function(){var t=this;if(this.groupName){var e=this.list.filter(function(e){return e.group_name===t.groupName});if(e.length>0)return void this.$message.error("分组名称重复");this.isEdit=!1;var i=this.list.map(function(t){return t.sort_order})||[],a=i.length>0?Math.max.apply(Math,(0,o.A)(i)):0,n=this.groupName,r=a+1;this.list.push({id:0,group_name:n,sort_order:r,status:1}),this.groupName=""}else this.$message.error("分组名称不能为空")},handleCancel:function(){this.isEdit=!1,this.groupName=""},handleSaveEdit:function(t){t.editing=!1,this.list=d()(this.list)},handleEdit:function(t){this.check()&&(t.editing=!0,this.list=d()(this.list))},handleDelete:function(t){var e=this.list.filter(function(e){return e.id!==t});this.list=d()(e)},handleMove:function(t){var e=this,i=this.list.findIndex(function(t){return t.id===e.selectedId}),a=this.list;if("up"===t){if(i>0){var n=[a[i],a[i-1]];a[i-1]=n[0],a[i]=n[1]}}else if(i<a.length-1){var r=[a[i],a[i+1]];a[i+1]=r[0],a[i]=r[1]}a.forEach(function(t,e){t.sort_order=e+1}),this.list=d()(a)}})}),E=D,P=(0,y.A)(E,F,G,!1,null,"c4fe2cec",null),j=P.exports,N={name:"Home",components:{AddGroup:j,FamilyEdit:C,FamilySort:k,FamilyBase:L.A},data:function(){return{loadPageData:!1,showGroupModal:!1,showFamilyBaseInfo:!1,showFamilySort:!1,familyType:"",familyEditId:0,familyGroupId:"",showEditFamilyModal:!1,dataList:I.p,groupList:[],selectedGroupId:"all"}},computed:(0,l.A)((0,l.A)({},(0,c.aH)({groupClan:function(t){return t.family.groupClan},hasLoadedGroup:function(t){return t.family.hasLoadedGroup}})),{},{filteredGroupList:function(){var t=this;if("all"===this.selectedGroupId)return this.groupList;var e=this.groupList.find(function(e){return e.id===t.selectedGroupId});return e&&e.children?[e].concat((0,o.A)(e.children)):[e]}}),watch:{groupClan:{handler:function(t,e){this.groupList=d()(t).sort(function(t,e){return t.sort_order-e.sort_order})},immediate:!0}},mounted:function(){var t=this;return(0,s.A)((0,r.A)().m(function e(){return(0,r.A)().w(function(e){while(1)switch(e.n){case 0:return e.n=1,t.refresh();case 1:return e.a(2)}},e)}))()},methods:(0,l.A)((0,l.A)({},(0,c.i0)(["GroupClanList","SetCurrentGroupId","SetCurrentClanId"])),{},{refresh:function(){var t=this;return(0,s.A)((0,r.A)().m(function e(){return(0,r.A)().w(function(e){while(1)switch(e.n){case 0:return t.loadPageData=!0,e.n=1,t.GroupClanList();case 1:t.loadPageData=!1;case 2:return e.a(2)}},e)}))()},handleClainSelected:function(t,e,i){this.SetCurrentGroupId(t.id),this.SetCurrentClanId(e.id),"px"===i?this.$router.push({path:"/px"}):"pw"===i?this.$router.push({path:"/pw"}):"ps"===i&&this.$router.push({path:"/ps"})},handleFamilyBaseInfo:function(t,e){t&&this.SetCurrentGroupId(t.id),e&&this.SetCurrentClanId(e.id),this.showFamilyBaseInfo=!this.showFamilyBaseInfo},handleFamilySort:function(t){this.familyGroupId=t.id,this.showFamilySort=!this.showFamilySort},handleCloseFamilySort:function(){this.familyGroupId="",this.showFamilySort=!this.showFamilySort},handleAdd:function(t){this.familyGroupId=t.id,this.familyType="add",this.familyEditId=0,this.showEditFamilyModal=!0},handleCloseEditModal:function(){this.showEditFamilyModal=!1},handleEdit:function(t,e){this.familyGroupId=t.id,this.familyType="edit",this.familyEditId=e.id,this.showEditFamilyModal=!0},handleDelete:function(t){var e=this;this.$confirm({title:"",content:"确定要删除家族「".concat(t.group_name,"」吗?"),okText:"确定",cancelText:"取消",onOk:function(){var t=(0,s.A)((0,r.A)().m(function t(){return(0,r.A)().w(function(t){while(1)switch(t.n){case 0:e.$message.success("暂未实现");case 1:return t.a(2)}},t)}));function i(){return t.apply(this,arguments)}return i}()})}})},M=N,$=(0,y.A)(M,a,n,!1,null,"5af73de4",null),z=$.exports}}]);